<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.3.34">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Estimating Movement Paths and Haul-out Behavior of Harbor Seals (Phoca vitulina) in Cook Inlet, Alaska</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="move-paths_files/libs/clipboard/clipboard.min.js"></script>
  <script src="move-paths_files/libs/quarto-html/quarto.js"></script>
  <script src="move-paths_files/libs/quarto-html/popper.min.js"></script>
  <script src="move-paths_files/libs/quarto-html/tippy.umd.min.js"></script>
  <script src="move-paths_files/libs/quarto-html/anchor.min.js"></script>
  <link href="move-paths_files/libs/quarto-html/tippy.css" rel="stylesheet">
  <link href="move-paths_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="move-paths_files/libs/bootstrap/bootstrap.min.js"></script>
  <link href="move-paths_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="move-paths_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="quarto-content" class="container-fluid page-layout-article">
<div class="page-columns">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#importing-tidy-ing-the-telemetry-data" class="nav-link active" data-scroll-target="#importing-tidy-ing-the-telemetry-data">Importing &amp; Tidy-ing the Telemetry Data</a>
<ul class="collapse">
<li><a href="#background" class="nav-link" data-scroll-target="#background">Background</a></li>
<li><a href="#data-handling-and-management" class="nav-link" data-scroll-target="#data-handling-and-management">Data Handling and Management</a></li>
<li><a href="#mapping-the-observed-location-data" class="nav-link" data-scroll-target="#mapping-the-observed-location-data">Mapping the Observed Location Data</a></li>
<li><a href="#distribution-of-data-across-time" class="nav-link" data-scroll-target="#distribution-of-data-across-time">Distribution of Data Across Time</a></li>
<li><a href="#percent-dry-timeline-data" class="nav-link" data-scroll-target="#percent-dry-timeline-data">Percent-dry Timeline Data</a></li>
</ul></li>
<li><a href="#movement-modeling-predicting-paths" class="nav-link" data-scroll-target="#movement-modeling-predicting-paths">Movement Modeling &amp; Predicting Paths</a>
<ul class="collapse">
<li><a href="#fit-movement-models-with-crawl-package" class="nav-link" data-scroll-target="#fit-movement-models-with-crawl-package">Fit movement models with <code>crawl</code> package</a></li>
<li><a href="#re-fit-any-problematic-deployments" class="nav-link" data-scroll-target="#re-fit-any-problematic-deployments">Re-fit any problematic deployments</a></li>
</ul></li>
<li><a href="#re-routing-paths-around-land-barriers" class="nav-link" data-scroll-target="#re-routing-paths-around-land-barriers">Re-routing Paths Around Land Barriers</a></li>
</ul>
</nav>
</div>
<main class="content">
<header id="title-block-header">
<h1 class="title display-7">Estimating Movement Paths and Haul-out Behavior of Harbor Seals (<em>Phoca vitulina</em>) in Cook Inlet, Alaska</h1>
</header>

<p><link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin=""> <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300&amp;display=swap" rel="stylesheet"></p>
<div class="callout callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Josh M. London
</div>
</div>
<div class="callout-body-container callout-body">
<p><em>Wildlife Biologist</em>, Marine Mammal Laboratory<br>
Alaska Fisheries Science Center, NOAA Fisheries<br>
Seattle, Washington</p>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Summary
</div>
</div>
<div class="callout-body-container callout-body">
<p>This document provides a description of the process used to import and tidy telemetry data observations from bio-loggers deployed on harbor seals in Cook Inlet, Alaska. The data include estimated location observations and percent-dry timelines that indicate the percentage of each hour the bio-logger was dry. The location observations are used to model the movement parameters and predict a likely track for each seal. Each of these movement paths is examined for regions that cross-land (not sensible for a harbor seal) and those sections are re-routed around the land. The initial movement model is developed using the R package <code>crawl</code> and the paths are re-routed around land with the R package <code>pathroutr</code>. The final data product is an <code>sf</code> spatial data frame of predicted points every hour and, when available, the associated percent-dry percentage for that hour â€” this indicates what percentage of the hour the seal was likely hauled out on land resting.</p>
</div>
</div>
<div class="cell">

</div>
<section id="importing-tidy-ing-the-telemetry-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-tidy-ing-the-telemetry-data">Importing &amp; Tidy-ing the Telemetry Data</h2>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<div class="cell">
<p></p><details>
<summary>code to create summary table</summary><p></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>summary_tbl <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(locs_data) <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(deployid, speno, sex, age, tag_family, deploy_dt, end_dt) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(speno, sex, age) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_tags =</span> <span class="fu">n_distinct</span>(tag_family), </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">deploy_start =</span> <span class="fu">min</span>(deploy_dt),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">deploy_end =</span> <span class="fu">max</span>(end_dt)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, age) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_tags =</span> <span class="fu">sum</span>(n_tags),</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n_seals =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Between 2004 and 2006, 76 were captured and released with satellite-linked bio-loggers attached as part of a research effort in Cook Inlet, Alaska. Each transmitter was glued to the hair on the back of the seal using durable epoxy. Fourteen of the seals were also equipped with specially developed transmitters that were attached to one of the rear flippers. <a href="#tbl-summary">Table&nbsp;1</a> provides more information on the distriubtion of deployments across sex and age classes. Transmissions from the 89 bio-loggers resulted in 73482 location estimates and 270168 haul-out behavior records. Harbor seals captured in central and southern Cook Inlet ranged as far southwest as the Semidi Islands and some seals used habitats around the north and northeast side of Kodiak Island. There was a strong seasonal pattern of more coastal and restricted spatial use during the spring and summer (breeding, pupping, molting) and more wide-ranging movements within and outside of Cook Inlet during the winter months. These insights into seasonal harbor seal movements, behavior and abundance are critical for understanding foraging ecology, marine habitat use, and risk of impacts from industrial accidents such as oil spills.</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-summary" class="anchored">
<div id="sjrkivsemm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#sjrkivsemm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: medium;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 90%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sjrkivsemm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sjrkivsemm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sjrkivsemm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sjrkivsemm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sjrkivsemm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sjrkivsemm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sjrkivsemm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sjrkivsemm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sjrkivsemm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sjrkivsemm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sjrkivsemm .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#sjrkivsemm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sjrkivsemm .gt_from_md > :first-child {
  margin-top: 0;
}

#sjrkivsemm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sjrkivsemm .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 0px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sjrkivsemm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#sjrkivsemm .gt_summary_row {
  color: #333333;
  background-color: #E5E5E5;
  text-transform: inherit;
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjrkivsemm .gt_first_summary_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#sjrkivsemm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
}

#sjrkivsemm .gt_first_grand_summary_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sjrkivsemm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sjrkivsemm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sjrkivsemm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sjrkivsemm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#sjrkivsemm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sjrkivsemm .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#sjrkivsemm .gt_left {
  text-align: left;
}

#sjrkivsemm .gt_center {
  text-align: center;
}

#sjrkivsemm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sjrkivsemm .gt_font_normal {
  font-weight: normal;
}

#sjrkivsemm .gt_font_bold {
  font-weight: bold;
}

#sjrkivsemm .gt_font_italic {
  font-style: italic;
}

#sjrkivsemm .gt_super {
  font-size: 65%;
}

#sjrkivsemm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table"><caption>Table 1:  The number of bio-loggers deployed on harbor seals in Cook Inlet, Alaska between 2004 and 2006 across sex and age class. A few seals were released with two devices attached; one adhered to the hair on dorsal side and another attached through the rear flipper inter-digital webbing. </caption>
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Bio-logger Deployments on Harbor Seals</th>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1"></th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">Sample Size</span>
      </th>
    </tr>
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1"># of tags<sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1"># of seals</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="3" class="gt_group_heading" style="font-weight: bold; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: darkgrey; border-top-width: 0px; border-top-style: solid; border-top-color: #000000;">Female</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">ADULT</td>
<td class="gt_row gt_right">20</td>
<td class="gt_row gt_right">16</td></tr>
    <tr><td class="gt_row gt_left gt_stub">SUBADULT</td>
<td class="gt_row gt_right">12</td>
<td class="gt_row gt_right">11</td></tr>
    <tr><td class="gt_row gt_left gt_stub">YEARLING<sup class="gt_footnote_marks">2</sup></td>
<td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">3</td></tr>
    <tr><td class="gt_row gt_left gt_stub">YOUNG OF YEAR</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">6</td></tr>
    <tr>
      <td class="gt_row gt_stub gt_right gt_summary_row gt_first_summary_row">total</td>
      <td class="gt_row gt_right gt_summary_row gt_first_summary_row" style="border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: #000000;">42</td>
      <td class="gt_row gt_right gt_summary_row gt_first_summary_row" style="border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: #000000;">36</td>
    </tr>
    <tr class="gt_group_heading_row">
      <td colspan="3" class="gt_group_heading" style="font-weight: bold; border-bottom-width: 2px; border-bottom-style: solid; border-bottom-color: darkgrey; border-top-width: 0px; border-top-style: solid; border-top-color: #000000;">Male</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">ADULT</td>
<td class="gt_row gt_right">23</td>
<td class="gt_row gt_right">23</td></tr>
    <tr><td class="gt_row gt_left gt_stub">SUBADULT</td>
<td class="gt_row gt_right">15</td>
<td class="gt_row gt_right">11</td></tr>
    <tr><td class="gt_row gt_left gt_stub">YEARLING<sup class="gt_footnote_marks">2</sup></td>
<td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">2</td></tr>
    <tr><td class="gt_row gt_left gt_stub">YOUNG OF YEAR</td>
<td class="gt_row gt_right">7</td>
<td class="gt_row gt_right">4</td></tr>
    <tr>
      <td class="gt_row gt_stub gt_right gt_summary_row gt_first_summary_row">total</td>
      <td class="gt_row gt_right gt_summary_row gt_first_summary_row" style="border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: #000000;">47</td>
      <td class="gt_row gt_right gt_summary_row gt_first_summary_row" style="border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: #000000;">40</td>
    </tr>
    <tr>
      <td class="gt_row gt_stub gt_right gt_grand_summary_row gt_first_grand_summary_row" style="font-weight: bold; border-top-width: 2px; border-top-style: solid; border-top-color: darkgrey;">total</td>
      <td class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row" style="font-weight: bold; border-top-width: 2px; border-top-style: solid; border-top-color: darkgrey;">89</td>
      <td class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row" style="font-weight: bold; border-top-width: 2px; border-top-style: solid; border-top-color: darkgrey;">76</td>
    </tr>
  </tbody>
  
  <tfoot>
    <tr class="gt_footnotes">
      <td colspan="3">
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>1</em>
          </sup>
           
          some seals were released with two bio-logger devices
          <br>
        </p>
        <p class="gt_footnote">
          <sup class="gt_footnote_marks">
            <em>2</em>
          </sup>
           
          age class 'YEARLING' is often combined with 'SUBADULT
          <br>
        </p>
      </td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="data-handling-and-management" class="level3">
<h3 class="anchored" data-anchor-id="data-handling-and-management">Data Handling and Management</h3>
<p>All the processes and code used for this project are <a href="https://github.com/jmlondon/cookinlet-seal-movt">available as a repository on GitHub</a>. Data retrieval, processing, analysis are all managed as a <em>pipeline</em> via the <code>targets</code> package in R. For a more detailed exploration of the code and process, examine the <a href="https://github.com/jmlondon/cookinlet-seal-movt/blob/main/_targets.R">_targets.R</a> file and the functions <a href="https://github.com/jmlondon/cookinlet-seal-movt/tree/main/R">within the projectâ€™s R folder</a>.</p>
<p>All of the tags deployed on seals in Cook Inlet were manufactured by <a href="https://wildlifecomputers.com">Wildlife Computer</a> and originally processed through their data portal. To facilitate access to data from the portal within R, we relied on the <code>wcUtils</code> R package which <a href="https://github.com/jmlondon/wcUtils">is available from GitHub</a>. All telemetry data within the Polar Ecosystems Program (PEP) is maintained within a PostgreSQL database. This also includes important details regarding the individual seal (e.g.&nbsp;<em>speno</em>, age class, sex, morphometrics) and additional deployment metadata for each bio-logger (e.g.&nbsp;<em>deployid</em>, deployment start/end times, tag serial number). Initial data were queried from the database and, for the location observations, a course speed filter was applied (7.5 meters/sec) to remove any egregiously wrong location estimates. The percent-dry timeline data were mostly as is from the database</p>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Caution
</div>
</div>
<div class="callout-body-container callout-body">
<p>The current version of the data delivered via <code>pins</code> <strong>does not group deployments by <em>speno</em></strong>. Instead each deployment is treated as a separate individual seal. This is problematic for those seals that were released with two bio-logging devices. This will be resolved in the next major iteration of the data published via <code>pins</code>.</p>
</div>
</div>
</section>
<section id="mapping-the-observed-location-data" class="level3">
<h3 class="anchored" data-anchor-id="mapping-the-observed-location-data">Mapping the Observed Location Data</h3>
<p>First, we will take a look at the spatial distribution of the observed location estimates (this is after the course speed filter has been applied). In <a href="#fig-obs-map">Figure&nbsp;1</a>, the observed locations are concentrated within the Cook Inlet region â€” as would be expected â€” but, note, there is considerable expansion of the range into the Shelikof Strait, Kodiak, and out toward the shelf break in the Gulf of Alaska. The error associated with observed locations is also evident as the spatial distribution extends well inland beyond what would be sensible for harbor seals.</p>
<div class="cell">
<p></p><details>
<summary>code for map data</summary><p></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(locs_data) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(locs_dt)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2004"</span>, <span class="st">"2005"</span>, <span class="st">"2006"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_crop</span>(sf<span class="sc">::</span><span class="fu">st_bbox</span>(<span class="fu">tar_read</span>(land_osm)))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>hexgrid <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_make_grid</span>(<span class="fu">st_bbox</span>(map_data) <span class="sc">%&gt;%</span> <span class="fu">st_as_sfc</span>(), <span class="at">cellsize =</span> <span class="dv">25</span><span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">what =</span> <span class="st">"polygons"</span>, <span class="at">square =</span> <span class="cn">FALSE</span>) </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>hexgrid <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="at">index =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">lengths</span>(hexgrid)), hexgrid)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>hexbin <span class="ot">&lt;-</span> <span class="fu">st_join</span>(map_data, hexgrid, <span class="at">join =</span> st_intersects)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>locs_count <span class="ot">&lt;-</span> hexgrid <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(hexbin, index) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(index, <span class="at">ct=</span>n)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-obs-map" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="move-paths_files/figure-html/fig-obs-map-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Spatial distribution of observed location estimates from bio-loggers deployed on harbor seals in Cook Inlet from 2004-2006.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="distribution-of-data-across-time" class="level3">
<h3 class="anchored" data-anchor-id="distribution-of-data-across-time">Distribution of Data Across Time</h3>
<p>As with spatial distribution, it can also be informative to explore how the amount of data varied over time. This is especially important with bio-logging data because not all deployments start at the same time and deployment end dates are determined by a combination of factors (e.g.&nbsp;battery life, tag failures, adhesive failures, molt, and animal behavior). For this research project, there were two research cruises per year. One was timed to occur just after molt (September-October) so devices adhered to the hair would have potential to last for 9-12 months. The other cruise was timed for May to correspond with the expected median tag duration from the fall cruise. This also ensured a good sample size of deployments would be active during the pupping season (~June).</p>
<div class="cell">
<p></p><details>
<summary>code to calculate locations/day</summary><p></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>locs_day_tbl <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(locs_data) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">yday =</span> lubridate<span class="sc">::</span><span class="fu">yday</span>(locs_dt),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(locs_dt)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2004"</span>, <span class="st">"2005"</span>, <span class="st">"2006"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(yday) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-locs-by-day" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="move-paths_files/figure-html/fig-locs-by-day-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Distribution of observed location data by day-of-year and pooled across all years (2004-2006). The gap in August corresponds to the annual molt when seals grow a new coat of hair and bio-loggers adhered to the hair are shed. The higher intensity of location data in the spring and fall is reflective of the timing of capture cruises (typically May and September).</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The density of locations presented in <a href="#fig-locs-by-day">Figure&nbsp;2</a> are pooled across all the years of the study. But, within a given year, there are larger gaps in data coverage that are important to note. <a href="#fig-locs-by-day-year">Figure&nbsp;3</a> presents the density of location data by year and provides a more insightful view. For instance, most of the data in the study for the months of January through April come from deployments in 2006. Only the months of May-July and September-December are represented in more than one year â€” all of which is to be expected given the original objectives of the study, typical duration of bio-loggers, and the timing of research cruises.</p>
<div class="cell">
<p></p><details>
<summary>code to calculate locations/day/year</summary><p></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>locs_day_year_tbl <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(locs_data) <span class="sc">%&gt;%</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">yday =</span> lubridate<span class="sc">::</span><span class="fu">yday</span>(locs_dt),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(locs_dt)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2004"</span>, <span class="st">"2005"</span>, <span class="st">"2006"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(year, yday) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-locs-by-day-year" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="move-paths_files/figure-html/fig-locs-by-day-year-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: Distribution of observed location data by day-of-year for each of the years in the study (2004-2006). The gaps (white space) correspond to periods of time within the year when no bio-loggers were transmitting. The higher intensity of location data in the spring and fall is reflective of the timing of capture cruises (typically May and September).</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="percent-dry-timeline-data" class="level3">
<h3 class="anchored" data-anchor-id="percent-dry-timeline-data">Percent-dry Timeline Data</h3>
<p>In addition to the location estimates, the bio-loggers in this study also recorded the percentage of each hour the wet/dry sensor was dry. This is a way to explore haul-out behavior because, other than a few rare instances when a seal rests on the surface for extended periods, the percent-dry can be interpreted as percent of the hour hauled out. Haul-out behavior data were recorded and transmitted via the Argos satellite network as hourly percent-dry timelines. For each hour of a day, the wet/dry sensor was polled by the tag firmware every few seconds and the percent of the hour in the dry state was calculated. On board the bio-logger, hourly percent-dry data were rounded to the nearest 10% inclusive of 0% and 100% and additional values at 3% and 98%.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-percent-dry" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="move-paths_files/figure-html/fig-percent-dry-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: Haul-out behavior observations recorded by a bio-logger deployed on a harbor seal over two years. Areas of the plot with white space represent missing data that were not successfully received from the tag.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Thereâ€™s currently an issue with the figure above b/c thereâ€™s missing data for entire months of July and August. Will need to supplement the data record with missing values to make the plot consistent.</p>
</div>
</div>
</section>
</section>
<section id="movement-modeling-predicting-paths" class="level2">
<h2 class="anchored" data-anchor-id="movement-modeling-predicting-paths">Movement Modeling &amp; Predicting Paths</h2>
<section id="fit-movement-models-with-crawl-package" class="level3">
<h3 class="anchored" data-anchor-id="fit-movement-models-with-crawl-package">Fit movement models with <code>crawl</code> package</h3>
<div class="cell" data-file="../R/fit_crawl.R">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit_crawl <span class="ot">&lt;-</span> <span class="cf">function</span>(locs_data_filt) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  locs <span class="ot">&lt;-</span> locs_data_filt <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(<span class="fu">starts_with</span>(<span class="st">"error_"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">quality =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(quality) <span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>             forcats<span class="sc">::</span><span class="fu">fct_relevel</span>(<span class="st">"3"</span>,<span class="st">"2"</span>,<span class="st">"1"</span>,<span class="st">"0"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(speno) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(locs_dt) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  locs<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(locs))<span class="sc">%do%</span>{</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(locs<span class="sc">$</span>speno[[i]],<span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> locs<span class="sc">$</span>data[[i]]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">arrange</span>(tmp, locs_dt)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">crwMLE</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      tmp, <span class="at">err.model=</span><span class="fu">list</span>(<span class="at">x=</span><span class="sc">~</span>quality<span class="dv">-1</span>),</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">Time.name =</span> <span class="st">"locs_dt"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">fixPar =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">250</span>), <span class="fu">log</span>(<span class="dv">500</span>), <span class="fu">log</span>(<span class="dv">1500</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">constr=</span><span class="fu">list</span>(<span class="at">lower=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">log</span>(<span class="dv">1500</span>),<span class="dv">3</span>), <span class="fu">rep</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">2</span>)),</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">upper=</span><span class="fu">rep</span>(<span class="cn">Inf</span>,<span class="dv">5</span>)),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">attempts=</span><span class="dv">8</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">retrySD=</span><span class="fl">0.25</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">initialSANN=</span><span class="cn">NULL</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># prior=function(x){dexp(x[1],1/2,log=TRUE) + dnorm(x[3],2,2.5)},</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="st">"L-BFGS-B"</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">inherits</span>(fit,<span class="st">"error"</span>)) fit <span class="ot">&lt;-</span> <span class="st">"fit_error"</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    fit</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(locs)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="re-fit-any-problematic-deployments" class="level3">
<h3 class="anchored" data-anchor-id="re-fit-any-problematic-deployments">Re-fit any problematic deployments</h3>
<div class="cell" data-file="../R/refit_crawl.R">
<p></p><details>
<summary>Code</summary><p></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>refit_crawl <span class="ot">&lt;-</span> <span class="cf">function</span>(locs) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">### re-fit with prior for animals with errors</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">### ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  locs<span class="sc">$</span>ok_fit <span class="ot">&lt;-</span> <span class="fu">map_chr</span>(locs<span class="sc">$</span>fit, class)<span class="sc">!=</span><span class="st">"character"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  prob_data <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(locs, <span class="sc">!</span>ok_fit)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  locs <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(locs, ok_fit)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  locs<span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    locs,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">map</span>(fit, <span class="sc">~</span>{.x<span class="sc">$</span>estPar}),</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cmat =</span> <span class="fu">map</span>(fit, <span class="sc">~</span>{.x<span class="sc">$</span>Cmat})</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(prob_data) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(locs)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Create normal prior for non-fitting animals</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  par <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, locs<span class="sc">$</span>par)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  avg_cmat <span class="ot">&lt;-</span> (<span class="fu">Reduce</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>, locs<span class="sc">$</span>cmat)<span class="sc">/</span><span class="fu">nrow</span>(locs))[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  pmu <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(par)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  pC <span class="ot">&lt;-</span> <span class="fu">var</span>(par) <span class="sc">+</span> avg_cmat</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="do">### Re-fit problem animals</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(prob_data)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    ln_prior <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">t</span>(x<span class="sc">-</span>pmu)<span class="sc">%*%</span><span class="fu">solve</span>(pC,(x<span class="sc">-</span>pmu))}</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    locs<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">i=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(locs))<span class="sc">%do%</span>{</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(locs<span class="sc">$</span>speno[[i]],<span class="st">":</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> locs<span class="sc">$</span>data[[i]]</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>      tmp <span class="ot">&lt;-</span> <span class="fu">arrange</span>(tmp, locs_dt)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      fit <span class="ot">&lt;-</span> <span class="fu">try</span>(<span class="fu">crwMLE</span>(</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>        tmp, <span class="at">err.model=</span><span class="fu">list</span>(<span class="at">x=</span><span class="sc">~</span>quality<span class="dv">-1</span>),</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">Time.name =</span> <span class="st">"locs_dt"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">fixPar =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">250</span>), <span class="fu">log</span>(<span class="dv">500</span>), <span class="fu">log</span>(<span class="dv">1500</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> pmu,</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">constr=</span><span class="fu">list</span>(<span class="at">lower=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">log</span>(<span class="dv">1500</span>),<span class="dv">3</span>), <span class="fu">rep</span>(<span class="sc">-</span><span class="cn">Inf</span>,<span class="dv">2</span>)),</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">upper=</span><span class="fu">rep</span>(<span class="cn">Inf</span>,<span class="dv">5</span>)),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">attempts=</span><span class="dv">10</span>,</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">retrySD=</span><span class="fl">0.25</span>,</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">initialSANN=</span><span class="cn">NULL</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">prior=</span>ln_prior,</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">method=</span><span class="st">"L-BFGS-B"</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">inherits</span>(fit,<span class="st">"error"</span>)) fit <span class="ot">&lt;-</span> <span class="st">"fit_error"</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>      fit</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    <span class="do">### Check again to see if there are problem animals</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>   locs<span class="sc">$</span>ok_fit <span class="ot">&lt;-</span>  <span class="fu">map_chr</span>(locs<span class="sc">$</span>fit, class)<span class="sc">!=</span><span class="st">"character"</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">all</span>(locs<span class="sc">$</span>ok_fit)){</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>      locs <span class="ot">&lt;-</span> <span class="fu">mutate</span>(</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>        locs,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">par =</span> <span class="fu">map</span>(fit, <span class="sc">~</span>{.x<span class="sc">$</span>estPar}),</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">cmat =</span> <span class="fu">map</span>(fit, <span class="sc">~</span>{.x<span class="sc">$</span>Cmat})</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span>{</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"!!! There are still problem fits, must investigate !!!"</span>)</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Animals: "</span>, <span class="fu">which</span>(<span class="sc">!</span>locs<span class="sc">$</span>ok_fit))</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(locs)</span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="re-routing-paths-around-land-barriers" class="level2">
<h2 class="anchored" data-anchor-id="re-routing-paths-around-land-barriers">Re-routing Paths Around Land Barriers</h2>
</section>
</main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /grid -->
</div> <!-- /content -->


</body></html>